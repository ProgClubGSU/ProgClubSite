---
import Layout from "@/layouts/Layout.astro";
import { getEvents, renderPortableText } from "@/lib/sanity.js";
import { DISCORD_LINK, SITE_TITLE } from "@/consts";

// Get all events and sort by date
const events = await getEvents();

// Group events by semester (you can customize this logic)
const currentEvents = events.filter(event => {
  if (event.date?.isTBD || !event.date?.value) return false;
  const eventDate = new Date(event.date.value);
  const now = new Date();
  // Consider events from the last 6 months as "current"
  return eventDate > new Date(now.getTime() - 6 * 30 * 24 * 60 * 60 * 1000);
});

const resourceCategories = [
  {
    name: "workshops",
    description: "hands-on learning sessions & tutorials",
    items: [
      { title: "Technical Interview Prep", description: "Comprehensive guide to technical interviews, common questions, and problem-solving strategies", status: "active" },
      { title: "Project Portfolio Building", description: "Learn how to showcase your projects effectively and build a compelling portfolio", status: "active" },
      { title: "Resume & LinkedIn Optimization", description: "Professional branding and networking strategies for tech careers", status: "active" },
      { title: "DSA Bootcamp Series", description: "Data structures and algorithms deep-dive sessions", status: "upcoming" }
    ]
  },
  {
    name: "tools",
    description: "development tools & platforms we recommend",
    items: [
      { title: "VS Code Extensions", description: "Essential extensions for productive coding", status: "active" },
      { title: "Git & GitHub Workflow", description: "Version control best practices and collaboration", status: "active" },
      { title: "Docker Containers", description: "Containerization for consistent development environments", status: "active" },
      { title: "Cloud Platforms (AWS/GCP)", description: "Getting started with cloud computing and deployment", status: "active" }
    ]
  },
  {
    name: "docs",
    description: "documentation & reference materials",
    items: [
      { title: "Club Handbook", description: "Everything you need to know about progsu", status: "active" },
      { title: "Event Archives", description: "Past workshop materials and recordings", status: "active" },
      { title: "Career Resources", description: "Job search strategies and industry insights", status: "active" },
      { title: "Study Guides", description: "Technical interview prep and CS fundamentals", status: "active" }
    ]
  },
  {
    name: "community",
    description: "connect with fellow builders",
    items: [
      { title: "Discord Server", description: "Real-time chat, project collaboration, and help", status: "active", link: DISCORD_LINK },
      { title: "Study Groups", description: "Peer learning sessions and group projects", status: "active" },
      { title: "Mentorship Program", description: "Connect with experienced developers and alumni", status: "upcoming" },
      { title: "Project Showcase", description: "Share your work and get feedback from the community", status: "active" }
    ]
  }
];
---

<Layout title={`Resources - ${SITE_TITLE}`}>
  <div class="min-h-screen bg-black relative overflow-hidden">
    <!-- Grid background -->
    <div class="absolute inset-0">
      <div class="w-full h-full opacity-3" style="background-image: linear-gradient(rgba(255,255,255,0.1) 1px, transparent 1px), linear-gradient(90deg, rgba(255,255,255,0.1) 1px, transparent 1px); background-size: 50px 50px;"></div>
    </div>
    
    <!-- Content -->
    <div class="relative z-10 px-8 py-16">
      <div class="max-w-6xl mx-auto">
        <!-- Brutalist Page Header -->
        <div class="mb-16 flex items-end justify-between">
          <div>
            <h1 class="text-4xl md:text-6xl font-bold text-white mb-2 tracking-tight" style="font-family: 'Helvetica Neue', sans-serif;">
              resources
            </h1>
            <div class="text-xs text-white/40 uppercase tracking-widest font-mono">
              // tools & knowledge base
            </div>
          </div>
          
          <!-- Resources Counter -->
          <div class="text-right">
            <div class="text-2xl font-bold text-white font-mono">
              [R1]
            </div>
            <div class="text-xs text-white/40 uppercase tracking-widest">
              docs
            </div>
          </div>
        </div>
        
        <!-- Terminal-style Directory Listing -->
        <div class="mb-12">
          <div class="border border-white/10 bg-white/[0.02] p-8">
            <div class="font-mono text-white/60 space-y-4">
              <div class="text-green-400 text-sm">$ ls resources/ --long</div>
              <div class="space-y-2">
                {resourceCategories.map(category => (
                  <div class="flex items-center space-x-4 hover:text-white/80 transition-colors cursor-pointer group">
                    <div class="text-white/40 text-xs w-8">drwx</div>
                    <div class="text-blue-400 group-hover:text-blue-300 font-medium">{category.name}/</div>
                    <div class="text-white/50 text-sm flex-1">{category.description}</div>
                    <div class="text-white/30 text-xs">{category.items.length} items</div>
                  </div>
                ))}
              </div>
            </div>
          </div>
        </div>
        
        <!-- Resource Categories -->
        <div class="space-y-16">
          {resourceCategories.map((category, categoryIndex) => (
            <div class="space-y-8">
              <!-- Category Header -->
              <div class="flex items-end justify-between">
                <div>
                  <h2 class="text-2xl md:text-3xl font-bold text-white mb-1 tracking-tight" style="font-family: 'Helvetica Neue', sans-serif;">
                    {category.name}
                  </h2>
                  <div class="text-sm text-white/50 font-mono">
                    // {category.description}
                  </div>
                </div>
                <div class="text-right">
                  <div class="text-lg font-bold text-white font-mono">
                    [{(categoryIndex + 1).toString().padStart(2, '0')}]
                  </div>
                </div>
              </div>
              
              <!-- Category Items -->
              <div class="grid grid-cols-1 md:grid-cols-2 gap-1">
                {category.items.map((item, itemIndex) => {
                  const isExternal = item.link && (item.link.startsWith('http') || item.link.startsWith('https'));
                  const Component = item.link ? 'a' : 'div';
                  const linkProps = item.link ? {
                    href: item.link,
                    target: isExternal ? '_blank' : undefined,
                    rel: isExternal ? 'noopener noreferrer' : undefined
                  } : {};
                  
                  return (
                    <Component 
                      {...linkProps}
                      class={`border border-white/10 bg-white/[0.02] p-6 ${item.link ? 'hover:bg-white/[0.05] hover:border-white/20 transition-all duration-200 cursor-pointer group' : ''}`}
                    >
                      <div class="space-y-3">
                        <!-- Item Header -->
                        <div class="flex items-center justify-between">
                          <div class="flex items-center space-x-3">
                            <div class="text-white/40 font-mono text-xs">
                              {(itemIndex + 1).toString().padStart(2, '0')}.
                            </div>
                            <h3 class={`text-white font-medium text-lg ${item.link ? 'group-hover:text-green-300' : ''}`} style="font-family: 'Helvetica Neue', sans-serif;">
                              {item.title}
                            </h3>
                          </div>
                          
                          <!-- Status Indicator -->
                          <div class={`text-xs font-mono px-2 py-1 rounded-sm ${
                            item.status === 'active' ? 'bg-green-500/20 text-green-400 border border-green-500/30' :
                            item.status === 'upcoming' ? 'bg-yellow-500/20 text-yellow-400 border border-yellow-500/30' :
                            'bg-gray-500/20 text-gray-400 border border-gray-500/30'
                          }`}>
                            {item.status}
                          </div>
                        </div>
                        
                        <!-- Item Description -->
                        <p class="text-white/60 text-sm leading-relaxed" style="font-family: 'Helvetica Neue', sans-serif;">
                          {item.description}
                        </p>
                        
                        {item.link && (
                          <div class="flex items-center text-white/40 group-hover:text-white/60 text-sm font-mono">
                            <span class="mr-2">â†’</span>
                            <span>access resource</span>
                          </div>
                        )}
                      </div>
                    </Component>
                  );
                })}
              </div>
            </div>
          ))}
        </div>
        
        <!-- Terminal-style Footer -->
        <div class="mt-16 border-t border-white/10 pt-8">
          <div class="font-mono text-white/60 space-y-2">
            <div class="text-green-400 text-sm">$ find . -name "*.help" | head -3</div>
            <div class="text-white/50 text-sm">./discord/general-help</div>
            <div class="text-white/50 text-sm">./workshops/ask-questions</div>
            <div class="text-white/50 text-sm">./mentors/office-hours</div>
            <div class="text-white/40 text-sm mt-4">// need help? reach out in discord or join our next workshop</div>
          </div>
        </div>
      </div>
    </div>
</Layout> 