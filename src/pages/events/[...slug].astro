---
import { getEvents, getEvent, renderPortableText } from "@/lib/sanity.js";
import BlogPost from "@/layouts/BlogPost.astro";

export async function getStaticPaths() {
  const events = await getEvents();
  return events.map((event) => ({
    params: { slug: event.slug.current },
    props: { event },
  }));
}

const { event } = Astro.props;
const descriptionHtml = renderPortableText(event.description);
---

<BlogPost 
  title={event.title}
  description={typeof event.description === 'string' ? event.description : 'Event description'}
  pubDate={new Date(event.date)}
  resources={event.resources}
>
  <div class="prose prose-lg mx-auto">
    <h1>{event.title}</h1>
    <p class="text-gray-600 mb-6">{new Date(event.date).toLocaleDateString()}</p>
    <div set:html={descriptionHtml} />
  </div>
</BlogPost>
